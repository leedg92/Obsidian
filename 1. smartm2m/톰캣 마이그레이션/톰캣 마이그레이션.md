# Apache Tomcat 9.0.108 ì—…ê·¸ë ˆì´ë“œ ê°€ì´ë“œ

**CentOS 7.2.1511 + Java 8 í™˜ê²½**

---

## ğŸš¨ ê¸´ê¸‰ ë³´ì•ˆ íŒ¨ì¹˜ í•„ìš”ì„±

- **CVE-2025-55668** (CVSS 8.8): Session Fixation ì·¨ì•½ì 
- **CVE-2025-48989** (CVSS 7.5): Resource Shutdown ì·¨ì•½ì 
- **í•„ìˆ˜ ë²„ì „**: Tomcat 9.0.108 ì´ìƒ

---

## ğŸ“‹ ì—…ê·¸ë ˆì´ë“œ ì ˆì°¨

### 1. ì‚¬ì „ ë°±ì—…

```bash
# ê¸°ì¡´ Tomcat ì „ì²´ ë°±ì—…
sudo cp -r /opt/tomcat /backup/tomcat_backup_$(date +%Y%m%d_%H%M%S)

# ì¤‘ìš” ì„¤ì • íŒŒì¼ë“¤ ê°œë³„ ë°±ì—…
sudo cp /opt/tomcat/conf/server.xml /backup/
sudo cp /opt/tomcat/conf/web.xml /backup/
sudo cp /opt/tomcat/conf/context.xml /backup/
sudo cp -r /opt/tomcat/webapps /backup/
```

### 2. ìƒˆ ë²„ì „ ë‹¤ìš´ë¡œë“œ ë° ì„¤ì¹˜

```bash
# Tomcat 9.0.108 ë‹¤ìš´ë¡œë“œ (ë³´ì•ˆ íŒ¨ì¹˜ ë²„ì „)
cd /opt
sudo wget https://archive.apache.org/dist/tomcat/tomcat-9/v9.0.108/bin/apache-tomcat-9.0.108.tar.gz

# ì••ì¶• í•´ì œ
sudo tar xzf apache-tomcat-9.0.108.tar.gz

# ë””ë ‰í† ë¦¬ ì´ë¦„ ë³€ê²½
sudo mv apache-tomcat-9.0.108 tomcat_new
```

### 3. ê¸°ì¡´ íŒŒì¼ë“¤ ë³µì‚¬

```bash
# webapps ë””ë ‰í† ë¦¬ (WAR íŒŒì¼ë“¤)
sudo cp -r /opt/tomcat/webapps/* /opt/tomcat_new/webapps/

# conf ì„¤ì • íŒŒì¼ë“¤
sudo cp /opt/tomcat/conf/server.xml /opt/tomcat_new/conf/
sudo cp /opt/tomcat/conf/web.xml /opt/tomcat_new/conf/
sudo cp /opt/tomcat/conf/context.xml /opt/tomcat_new/conf/

# bin ë””ë ‰í† ë¦¬ì˜ ì»¤ìŠ¤í…€ íŒŒì¼ë“¤ (ìˆë‹¤ë©´)
sudo cp /opt/tomcat/bin/setenv.sh /opt/tomcat_new/bin/ 2>/dev/null || echo "setenv.sh not found - will create new"

# lib ë””ë ‰í† ë¦¬ì˜ ì»¤ìŠ¤í…€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ (ìˆë‹¤ë©´)
sudo cp -r /opt/tomcat/lib/* /opt/tomcat_new/lib/ 2>/dev/null || echo "No custom libs to copy"

# ì†Œìœ ê¶Œ ì„¤ì •
sudo chown -R tomcat:tomcat /opt/tomcat_new
```

### 4. setenv.sh ì„¤ì • (ê°€ì¥ ì¤‘ìš”!)

```bash
# setenv.sh íŒŒì¼ ìƒì„±/ìˆ˜ì •
sudo vi /opt/tomcat_new/bin/setenv.sh

# ë‹¤ìŒ ë‚´ìš© ì¶”ê°€ (ê¸°ì¡´ ë‚´ìš© ì•„ë˜ì— ì¶”ê°€í•˜ê±°ë‚˜ ìƒˆë¡œ ìƒì„±)
#!/bin/bash
# CentOS 7.2.1511 + Java 8 + Tomcat 9.0.108 í˜¸í™˜ì„± ì„¤ì •

# ì—”íŠ¸ë¡œí”¼ ì†ŒìŠ¤ ì„¤ì • (RANDNUM ì´ìŠˆ í•´ê²°)
export JAVA_OPTS="$JAVA_OPTS -Djava.security.egd=file:/dev/./urandom"

# SSL/TLS ì„¤ì • (Java 8 í˜¸í™˜)
export JAVA_OPTS="$JAVA_OPTS -Dhttps.protocols=TLSv1.2"
export JAVA_OPTS="$JAVA_OPTS -Djdk.tls.client.protocols=TLSv1.2"

# ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬
sudo chmod +x /opt/tomcat_new/bin/setenv.sh
```

### 5. ì„œë¹„ìŠ¤ êµì²´

```bash
# Tomcat ì„œë¹„ìŠ¤ ì¤‘ì§€
sudo systemctl stop tomcat

# ê¸°ì¡´ ë””ë ‰í† ë¦¬ ë°±ì—…ìš© ì´ë¦„ ë³€ê²½
sudo mv /opt/tomcat /opt/tomcat_old

# ìƒˆ ë””ë ‰í† ë¦¬ë¥¼ ì‹¤ì œ ê²½ë¡œë¡œ ì´ë™
sudo mv /opt/tomcat_new /opt/tomcat

# ì„œë¹„ìŠ¤ ì‹œì‘
sudo systemctl start tomcat
```

### 6. ë™ì‘ í™•ì¸

```bash
# ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
sudo systemctl status tomcat

# ë¡œê·¸ í™•ì¸
tail -f /opt/tomcat/logs/catalina.out

# í¬íŠ¸ í™•ì¸
netstat -tlnp | grep :8080

# HTTP ì ‘ì† í…ŒìŠ¤íŠ¸
curl -I http://localhost:8080/

# HTTPS ì ‘ì† í…ŒìŠ¤íŠ¸ (SSL ì„¤ì •ì´ ìˆë‹¤ë©´)
curl -I -k https://localhost:8443/
```

---

## ğŸ”§ í•„ìˆ˜ ì„¤ì • ìš”ì•½

### setenv.shì— ë°˜ë“œì‹œ ì¶”ê°€í•  3ì¤„

```bash
export JAVA_OPTS="$JAVA_OPTS -Djava.security.egd=file:/dev/./urandom"
export JAVA_OPTS="$JAVA_OPTS -Dhttps.protocols=TLSv1.2"
export JAVA_OPTS="$JAVA_OPTS -Djdk.tls.client.protocols=TLSv1.2"
```

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

1. **Java ë²„ì „**: Java 8 ê·¸ëŒ€ë¡œ ì‚¬ìš© ê°€ëŠ¥
2. **setenv.sh**: ì—†ìœ¼ë©´ ìƒˆë¡œ ìƒì„±, ìˆìœ¼ë©´ ìœ„ 3ì¤„ë§Œ ì¶”ê°€
3. **í¬íŠ¸ ì„¤ì •**: ê¸°ì¡´ í¬íŠ¸ ì„¤ì • ê·¸ëŒ€ë¡œ ìœ ì§€
4. **ë°©í™”ë²½**: í•„ìš”ì‹œ 8080, 8443 í¬íŠ¸ ê°œë°© í™•ì¸
5. **ë°±ì—…**: ë°˜ë“œì‹œ ì‘ì—… ì „ ë°±ì—… ì™„ë£Œ

---

## ğŸš‘ ë¡¤ë°± ë°©ë²• (ë¬¸ì œ ë°œìƒì‹œ)

```bash
# ì„œë¹„ìŠ¤ ì¤‘ì§€
sudo systemctl stop tomcat

# ê¸°ì¡´ ë²„ì „ìœ¼ë¡œ ë³µêµ¬
sudo mv /opt/tomcat /opt/tomcat_failed
sudo mv /opt/tomcat_old /opt/tomcat

# ì„œë¹„ìŠ¤ ì‹œì‘
sudo systemctl start tomcat
```

---

## ğŸ“ í™•ì¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] ë°±ì—… ì™„ë£Œ
- [ ] Tomcat 9.0.108 ë‹¤ìš´ë¡œë“œ
- [ ] ê¸°ì¡´ íŒŒì¼ë“¤ ë³µì‚¬ ì™„ë£Œ
- [ ] setenv.shì— 3ì¤„ ì¶”ê°€
- [ ] ì„œë¹„ìŠ¤ êµì²´ ì™„ë£Œ
- [ ] HTTP/HTTPS ì ‘ì† í™•ì¸
- [ ] ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë™ì‘ í™•ì¸
- [ ] ë¡œê·¸ ì—ëŸ¬ ì—†ìŒ í™•ì¸

**ì‘ì—… ì˜ˆìƒ ì‹œê°„**: 10-15ë¶„ (ë‹¤ìš´íƒ€ì„ 2-3ë¶„)