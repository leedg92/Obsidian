#### forTrucker ë¶™ì€ ì•¤ë“œí¬ì¸íŠ¸ : ìš´ì†¡ì‚¬ì›¹ -> bctrans ìš”ì²­ ë¶€

---
## **ë°˜ì¶œì… ìœ íš¨ì„± ê²€ì¦ í•¨ìˆ˜ íë¦„(1~5)**

### 1. ë©”ì„œë“œë³„

### 1ï¸âƒ£ **ìš´ì†¡ì‚¬ â†’ bctrans**
```
   HTTP POST /tss/group/trucker/verify
	   â†“
   [TssGroupOrderController.java -> verifyGroupOrderByTrucker]
   TssGroupOrderController.verifyGroupOrderByTrucker()
	   â†“
   [TssGroupOrderService.java -> verifyGroupOrderByTrucker]
   TssGroupOrderService.verifyGroupOrderByTrucker()
```

### 2ï¸âƒ£ **bctrans â†’ í„°ë¯¸ë„**
```
	   â†“
   [TssGroupOrderService.java -> requestTransOrderNoVerify]
   requestTransOrderNoVerify()
	   â†“
   [TssGroupOrderAsyncService.java -> requestTransOrderNoVerify]
   TssGroupOrderAsyncService.requestTransOrderNoVerify()
	   â†“
   apiRestTemplate.exchange(í„°ë¯¸ë„URL, POST, ê²€ì¦ë°ì´í„°)
```

### 3ï¸âƒ£ **í„°ë¯¸ë„ ì²˜ë¦¬**â“ **bctrans ë°– (í™•ì¸ ë¶ˆê°€)**

### 4ï¸âƒ£ **í„°ë¯¸ë„ â†’ bctrans (ì½œë°±)**
```
   HTTP POST /tss/group/invoke/verifyResult/group
	   â†“
   [TssGroupOrderAlarmController.java -> saveGroupOrderTerminalVerifyResultAsync]
   TssGroupOrderAlarmController.saveGroupOrderTerminalVerifyResultAsync()
	   â†“
   [TssGroupOrderService.java -> processGroupOrderTerminalVerifyResultAsync]
   TssGroupOrderService.processGroupOrderTerminalVerifyResultAsync()
```

### 5ï¸âƒ£ **bctrans â†’ ìš´ì†¡ì‚¬**
```
	   â†“
   [TssGroupOrderPushService.java -> sendGroupOrderVerifyResultAlarm]
   TssGroupOrderPushService.sendGroupOrderVerifyResultAlarm()
	   â†“
   webClientService.sendRequestAsync(ìš´ì†¡ì‚¬URL, POST, ê²°ê³¼ë°ì´í„°)
```

### 2. urlë³„

### 1ï¸âƒ£ **ìš´ì†¡ì‚¬ â†’ bctrans**
```
POST /tss/group/trucker/verify
Body: { dispatchGroup, conList, truckList }
```

### 2ï¸âƒ£ **bctrans â†’ í„°ë¯¸ë„**
```
POST {í„°ë¯¸ë„API}/verify
Body: { ê²€ì¦ë°ì´í„° }
```
   
### 3ï¸âƒ£ **(BCNT, BCTë§Œ í•´ë‹¹) í„°ë¯¸ë„ â†’ bctrans (ê³ ì • URL)**
```
POST /tss/group/invoke/verifyResult/group  // ğŸ”’ ê³ ì •ëœ ì½œë°± URL
Body: { ê²€ì¦ê²°ê³¼ }
```
   
### 4ï¸âƒ£ **bctrans â†’ ìš´ì†¡ì‚¬ (ì‚¬ì „ ë“±ë¡ëœ URL)**
```
POST {ìš´ì†¡ì‚¬ì½œë°±URL}/group/verify/result   // ğŸ—ƒï¸ DBì—ì„œ ì¡°íšŒí•œ URL
Body: { ê²€ì¦ê²°ê³¼ }
```

---

## **ê·¸ë£¹ ì •ë³´ ìƒì„± í•¨ìˆ˜ íë¦„(6~7)**

### 1. ë©”ì„œë“œë³„

### 6ï¸âƒ£ **ìš´ì†¡ì‚¬ â†’ bctrans**
```
HTTP POST /tss/group/trucker/create
   â†“
[TssGroupOrderController.java -> createShippingOrderAndGroupOrder]
TssGroupOrderController.createShippingOrderAndGroupOrder()
   â†“
[TssGroupOrderService.java -> createGroupOrderForTrucker]
TssGroupOrderService.createGroupOrderForTrucker()
```

### 7ï¸âƒ£ **bctrans ë‚´ë¶€ ì²˜ë¦¬**
```
   â†“
[TssGroupOrderService.java -> assertValidate]
assertValidate() - ìœ íš¨ì„± ê²€ì¦
   â†“
[TssGroupOrderRepository.java -> selectExistsContainer]
selectExistsContainer() - ì¤‘ë³µ ì²´í¬
   â†“
dispatchGroup ìë™ ìƒì„±
   â†“
[BChainService.java -> exchange]
bChainService.exchange("/trans/CreateCopinoWithGroup") - BC ì½”í”¼ë…¸ ìƒì„±
   â†“
[TssGroupOrderService.java -> createGroupOrder]
createGroupOrder() â†’ saveGroupOrder() - DB ì €ì¥
   â†“
[TssGroupOrderService.java -> verifyGroupOrderByTrucker]
verifyGroupOrderByTrucker() - ìë™ ìœ íš¨ì„± ê²€ì¦ ì‹¤í–‰
```

### 2. urlë³„

### 6ï¸âƒ£ **(BCNT, BCTë§Œ í•´ë‹¹) ìš´ì†¡ì‚¬ â†’ bctrans**
```
POST /tss/group/trucker/create
Body: { conList, truckList }  // dispatchGroup ì—†ìŒ, bctransê°€ ìë™ ìƒì„±
```

### 7ï¸âƒ£ **bctrans â†’ BC**
```
POST {BC_URL}/trans/CreateCopinoWithGroup
Body: { info: {ìš´ì†¡ì‚¬ì •ë³´}, data: {ë°°ì°¨ê·¸ë£¹, ì»¨í…Œì´ë„ˆëª©ë¡} }
```

**ì°¸ê³ **: ê·¸ë£¹ ìƒì„± ì™„ë£Œ í›„ ìë™ìœ¼ë¡œ **ë°˜ì¶œì… ìœ íš¨ì„± ê²€ì¦ í”„ë¡œì„¸ìŠ¤(1-5ë²ˆ)**ê°€ ì‹¤í–‰ë¨

---
## **ê·¸ë£¹ì˜¤ë” ì‹œì‘ ë° ìš´ì†¡ì •ë³´ ìƒì„± í•¨ìˆ˜ íë¦„(8~13)**

### 1. ë©”ì„œë“œë³„

### 8ï¸âƒ£ **ìš´ì†¡ì‚¬ â†’ bctrans: ê·¸ë£¹ì˜¤ë” ì‹œì‘**
```
HTTP POST /tss/group/updateStatus
   â†“
[TssGroupOrderController.java -> updateGroupOrderStatus]
TssGroupOrderController.updateGroupOrderStatus()
   â†“
[TssGroupOrderService.java -> updateGroupOrderStatus]
TssGroupOrderService.updateGroupOrderStatus()
   â†“
[TssGroupOrderProcessService.java -> startGroupOrder]
TssGroupOrderProcessService.startGroupOrder()
```

### 9ï¸âƒ£ **bctrans â†’ í„°ë¯¸ë„: ë°°ì°¨ í›„ë³´ ì €ì¥ ë° ëª©ë¡ ì „ì†¡**
```
   â†“
[TssGroupOrderProcessService.java -> processSingleGroupOrder]
processSingleGroupOrder() â†’ filterTargetTrucks()
   â†“
[TssGroupOrderAsyncService.java -> sendStartAlarmToTerminal]
sendStartAlarmToTerminal("StartGroupOrder", groupOrder, targetTruckList)
   â†“
webClientService.sendRequestAsync(í„°ë¯¸ë„URL, POST, ë°°ì°¨í›„ë³´ëª©ë¡)
```

### ğŸ”Ÿ **í„°ë¯¸ë„ â†’ TOS: ê·¸ë£¹ ì˜¤ë” ì •ë³´ ìš”ì²­** â“ **bctrans ë°– (í™•ì¸ ë¶ˆê°€)**

### 1ï¸âƒ£1ï¸âƒ£ **í„°ë¯¸ë„ â†’ BC: ìš´ì†¡ì˜¤ë” ì •ë³´ ìƒì„± ìš”ì²­** â“ **bctrans ë°– (í™•ì¸ ë¶ˆê°€)**

### 1ï¸âƒ£2ï¸âƒ£ **BC â†’ bctrans: ìš´ì†¡ì˜¤ë” ë°œí–‰**
```
HTTP POST /itt/invoke/alarm
   â†“
[IttInvokeAlarmController.java -> bctansInvokeAlarmComplete]
IttInvokeAlarmController.bctansInvokeAlarmComplete()
   â†“
[IttInvokeAlarmController.java -> bctansInvokeAlarmComplete]
methodê°€ ë­˜ë¡œ ë“¤ì–´ì˜¬ì§„ ëª¨ë¥´ê² ì§€ë§Œ ì¼ë‹¨ BCì—ì„œ ë­”ê°€ ì´ì£¼ëŠ”ê±°ê°™ìŒ
```

### 1ï¸âƒ£3ï¸âƒ£  **bctrans ë‚´ë¶€: ìš´ì†¡ ì •ë³´ ìƒì„± + ì˜¬ì»¨e ì „ì†¡**
```
   â†“
[IttInvokeAlarmController.java -> bctansInvokeAlarmComplete]
methodì— ë”°ë¼ ë‚´ë¶€ ë¡œì§ ì‹¤í–‰
   â†“
[TssAbstractInvokeStrategy.java -> sendTerminalEventToTrucker]
sendTerminalEventToTrucker() - ìš´ì†¡ì‚¬ ì•Œë¦¼
+ ì˜¬ì»¨e ì „ì†¡
```

### 2. urlë³„

### 8ï¸âƒ£ **ìš´ì†¡ì‚¬ â†’ bctrans**
```
POST /tss/group/updateStatus
Body: { dispatchGroup, groupStatus: "START" }
```

### 9ï¸âƒ£ **bctrans â†’ í„°ë¯¸ë„**
```
POST {í„°ë¯¸ë„API}/invoke/alarm
Body: { method: "StartGroupOrder", message: {ë°°ì°¨ì •ë³´, íŠ¸ëŸ­ëª©ë¡} }
```

###  ğŸ”Ÿ **í„°ë¯¸ë„ â†’ TOS â“ **bctrans ë°– (í™•ì¸ ë¶ˆê°€)**

### 1ï¸âƒ£1ï¸âƒ£ **í„°ë¯¸ë„ â†’ BC: â“ **bctrans ë°– (í™•ì¸ ë¶ˆê°€)**

### 1ï¸âƒ£2ï¸âƒ£ **BC â†’ bctrans**
```
POST /itt/invoke/alarm
Body: { method: ?? , resultMessage: {ìš´ì†¡ì˜¤ë”ì •ë³´} }
```

### 1ï¸âƒ£3ï¸âƒ£  **bctrans ë‚´ë¶€ ì²˜ë¦¬**
```
DB ì €ì¥ ë° ìš´ì†¡ì‚¬ ì•Œë¦¼ ì „ì†¡ + ì˜¬ì»¨e ì „ì†¡
```
