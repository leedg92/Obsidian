# 전공 추천 시스템 로직

## 1. 점수 계산 시스템

### 1.1 기본 점수 계산
총점 = (직업 매칭 점수 × 5) + (계열(직업군) 매칭 점수 × 3) + (학과소개 매칭 점수 × 2)

### 1.2 직업별 가중치 적용
- 각 직업의 가중치는 검사 결과에 따라 다르게 적용
- 직업선호도/직업적성 검사 각각 0.5점 총점 분배
- 직업별 가중치 = 0.5 / 해당 검사의 직업 수

## 2. 매칭 프로세스

### 2.1 직업 매칭 점수 계산

- 학과별 관련 직업(KNOW_JOB_NM)과 입력 직업 간 매칭
- 매칭 점수 기준:
  - 완전 일치: 10점
  - 핵심구문 일치: 7점 (연속된 2단어 이상 일치)
  - 부분 포함: 3점
- 정규화된 직업명으로 비교
  - 특수문자 및 불필요한 공백 제거
  - "및"으로 구분된 직업을 개별 직업으로 분리
  - 맨 끝에 있는 "등" 제거
  - 2글자 미만 키워드 제외

### 2.2 계열 및 학과소개 매칭
- 계열 매칭: 직업-계열 간 키워드 매칭
- 학과소개 매칭: 직업-학과소개 텍스트 유사도 분석

### 2.3 임계값
1. 전체 학과의 점수 분포 분석
2. 상위 30%만 추천 대상으로 도출되도록 설정

## 3. 최종 추천 결과 생성

### 3.1 점수 정렬 및 필터링
- 점수 기준 내림차순 정렬
- 임계값 이상 점수 필터링
- 상위 5개(MAX_RECOMMENDATIONS) 선정

### 3.2 교내 전공 매핑
- 워크넷 학과 ID로 교내 전공 매핑
- 중복 전공의 경우 점수 누적 처리 (가중치 1.5)

### 3.3 결과 포맷
```
json
{
	"result": "DONE",
	"recommendations": [{
		"majorCode": "교내전공코드",
		"majorName": "교내전공명",
		"matchScore": "매칭점수"
	}],
	"usedTests": ["사용된 검사 목록"]
}
```

## 4. 데이터베이스 구조

### 4.1 워크넷 학과 정보 (AIEDU.UNI_WORKNET_MAJOR_DETAIL)
- KNOW_DPT_ID: 계열 ID
- KNOW_SCH_DPT_ID: 학과 ID
- KNOW_DPT_NM: 계열명
- KNOW_SCH_DPT_NM: 학과명
- SCH_DPT_INTRO_SUM: 학과소개
- KNOW_JOB_NM: 관련 직업명

### 4.2 교내 전공 매핑 (UNI_WORKNET_MJ_MAP)
- MJ_CD: 교내 전공 코드
- KNOW_DPT_ID: 워크넷 계열 ID
- KNOW_SCH_DPT_ID: 워크넷 학과 ID

### 4.3 교내 전공 정보 (COM.CMMN050)
- DEPT_CD: 전공 코드
- DEPT_KOR_NM: 전공명