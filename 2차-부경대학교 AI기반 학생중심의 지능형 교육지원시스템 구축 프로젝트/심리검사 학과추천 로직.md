# 순위 결정 로직

## 1. 워크넷 학과 추천 순위 결정

### 1.1 총점 계산
총점 = (직업 매칭 점수 × 5) + (계열 매칭 점수 × 3) + (학과소개 매칭 점수 × 2)

### 1.2 각 항목별 점수 산정

#### A. 직업 매칭 점수
- 완전 일치: 10점
  - 예: "기계공학기술자" = "기계공학기술자"
- 핵심구문 일치: 7점
  - 연속된 2단어 이상이 일치하는 경우
  - 예: "자동차 정비원" ↔ "자동차 기술원"
- 부분 포함: 3점
  - 한 직업명이 다른 직업명에 포함되는 경우
  - 길이 차이가 2글자 이하일 때만 적용
  - 예: "기계기술자" ↔ "기계공학기술자"

#### B. 계열 매칭 점수
- 직업명에서 추출한 2글자 이상의 키워드가 계열명에 포함될 때마다 3점
- 예시:
  - 직업명: "기계공학기술자"
  - 계열명: "기계공학계열"
  - 매칭 키워드: "기계", "공학" → 6점

#### C. 학과소개 매칭 점수
- 직업명에서 추출한 2글자 이상의 키워드가 학과소개에 포함될 때마다 2점
- 예시:
  - 직업명: "자동차정비원"
  - 학과소개: "...자동차 산업 분야의 정비 기술을..."
  - 매칭 키워드: "자동차", "정비" → 4점

## 2. 순위 결정 과정

### 2.1 심리검사 결과 수집
- 직업선호도검사(jobPrefExamS)의 추천 직업 목록
- 직업적성검사(adultJobAptReviseExam)의 추천 직업 5개
- 두 검사 모두 수행한 경우 모든 직업을 통합하여 처리

### 2.2 워크넷 학과 매칭
1. 수집된 모든 직업에 대해 워크넷 학과와 매칭 점수 계산
2. 최소 매칭 점수(10점) 이상인 학과만 선별
3. 총점이 높은 순서대로 정렬
4. 상위 5개(MAX_RECOMMENDATIONS) 워크넷 학과 선정

### 2.3 교내 전공 매핑
1. 선정된 워크넷 학과를 교내 전공과 매핑
2. 매핑 시 워크넷 학과의 매치 스코어를 함께 전달
3. 최종 추천 목록에 포함되는 정보:
   - majorCode: 교내 전공 코드
   - majorName: 교내 전공명
   - matchScore: 워크넷 학과 매칭 점수

## 3. 결과 형식

```
json
{
	"result": "DONE",
	"recommendations": [
	{
		"majorCode": "교내전공코드",
		"majorName": "교내전공명",
		"matchScore": 매칭점수
	},
	...
	],
	"usedTests": ["직업선호도검사", "직업적성검사"]}
```

## 4. 특이사항
- 직업명 정규화 처리: 특수문자, 공백 제거
- 2글자 이상 단어만 매칭하여 불필요한 매칭 최소화
- 각 매칭 항목별 가중치 차등 적용
- 워크넷 학과 순위를 보존하여 교내 전공 추천의 우선순위 결정
- 최종 추천 전공 수는 워크넷 학과와의 매핑 관계에 따라 유동적

## 5. 데이터베이스 테이블
### 5.1 워크넷 학과 정보 (AIEDU.UNI_WORKNET_MAJOR_DETAIL)
- KNOW_DPT_ID: 계열 ID
- KNOW_SCH_DPT_ID: 학과 ID
- KNOW_DPT_NM: 계열명
- KNOW_SCH_DPT_NM: 학과명
- SCH_DPT_INTRO_SUM: 학과소개
- ADOPT_CERT_CONT: 자격증 정보
- KNOW_JOB_NM: 관련 직업명
- USE_YN: 사용여부

### 5.2 교내 전공 매핑 (UNI_WORKNET_MJ_MAP)
- MJ_CD: 교내 전공 코드
- KNOW_DPT_ID: 워크넷 계열 ID
- KNOW_SCH_DPT_ID: 워크넷 학과 ID
- ISDELETE: 삭제여부

### 5.3 교내 전공 정보 (COM.CMMN050)
- DEPT_CD: 전공 코드
- DEPT_KOR_NM: 전공명