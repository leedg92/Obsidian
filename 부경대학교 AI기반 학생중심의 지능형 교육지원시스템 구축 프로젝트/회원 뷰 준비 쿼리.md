CREATE OR REPLACE VIEW "AIEDU"."VIEW_PKNU_MEMBER"("MEMBER_IDX", "MEMBER_ID", "MEMBER_PWD", "MEMBER_NAME", "USERTYPE_IDX", USERTYPE_NM, "DEPT_CD") AS
SELECT 
    MEMBER_IDX AS MEMBER_IDX,
    MEMBER_ID AS MEMBER_ID,
    MEMBER_PWD AS MEMBER_PWD,
    MEMBER_NAME AS MEMBER_NAME,
    USERTYPE_IDX AS USERTYPE_IDX,
    '관리자' AS USERTYPE_NM,
    '' AS DEPT_CD
FROM RBS_MEMBER_INFO
UNION ALL
SELECT 
    A.USER_NO AS MEMBER_IDX,
    A.USER_NO AS MEMBER_ID,    
    B.USER_PWD AS MEMBER_PWD,
    A.KOR_NM AS MEMBER_NAME,
    45 AS USERTYPE_IDX, --조교
    '조교' AS USERTYPE_NM,
    A.DEPT_CD AS DEPT_CD
FROM COM.V_BSAC_USER A, 
     COM.CMMN040 B
WHERE 
 A.USER_NO = B.USER_ID
AND A.USER_TYPE = 'A'
AND A.USER_ST IN ('A0001001',
'A0001002')
AND A.USER_FG = 'A0012040'
UNION ALL
SELECT 
    A.USER_NO AS MEMBER_IDX,
    A.USER_NO AS MEMBER_ID,    
    B.USER_PWD AS MEMBER_PWD,
    A.KOR_NM AS MEMBER_NAME,
    10 AS USERTYPE_IDX,  --교수
    '교수' AS USERTYPE_NM,
    A.DEPT_CD AS DEPT_CD
FROM COM.V_BSAC_USER A, 
     COM.CMMN040 B
WHERE 
 A.USER_NO = B.USER_ID
AND A.USER_TYPE = 'A'
AND A.USER_ST IN ('A0001001',
'A0001002')
AND A.USER_FG = 'A0012070'
UNION ALL
SELECT 
    A.USER_NO AS MEMBER_IDX,
    A.USER_NO AS MEMBER_ID,    
    B.USER_PWD AS MEMBER_PWD,
    A.KOR_NM AS MEMBER_NAME,
    46 AS USERTYPE_IDX,  --직원
    '직원' AS USERTYPE_NM,
    A.DEPT_CD AS DEPT_CD
FROM COM.V_BSAC_USER A, 
     COM.CMMN040 B
WHERE 
 A.USER_NO = B.USER_ID
AND A.USER_TYPE = 'A'
AND A.USER_ST IN ('A0001001',
'A0001002')
AND SUBSTR(WKGD_CD,0,2) != '14';
