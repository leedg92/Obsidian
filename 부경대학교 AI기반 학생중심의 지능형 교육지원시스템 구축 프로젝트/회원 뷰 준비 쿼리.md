
select 
    MEMBER_IDX AS MEMBER_IDX,
    MEMBER_ID AS MEMBER_ID,
    MEMBER_PWD AS MEMBER_PWD,
    MEMBER_NAME AS MEMBER_NAME,
    USERTYPE_IDX AS USERTYPE_IDX,
    '' as dept_cd
from rbs_member_info
union all
select 
    a.user_no as member_idx,
    a.user_no as member_id,    
    b.user_pwd as member_pwd,
    a.kor_nm as member_name,
    45 as usertype_idx,
    a.dept_cd as dept_cd
from COM.V_BSAC_USER a, 
     COM.CMMN040 b
where 
 a.user_no = b.user_id
and a.user_type = 'A'
and a.user_st in ('A0001001',
'A0001002')
and a.user_fg = 'A0012040'
union all
select 
    a.user_no as member_idx,
    a.user_no as member_id,    
    b.user_pwd as member_pwd,
    a.kor_nm as member_name,
    10 as usertype_idx,
    a.dept_cd as dept_cd
from COM.V_BSAC_USER a, 
     COM.CMMN040 b
where 
 a.user_no = b.user_id
and a.user_type = 'A'
and a.user_st in ('A0001001',
'A0001002')
and a.user_fg = 'A0012070'
union all
select 
    a.user_no as member_idx,
    a.user_no as member_id,    
    b.user_pwd as member_pwd,
    a.kor_nm as member_name,
    46 as usertype_idx,
    a.dept_cd as dept_cd
from COM.V_BSAC_USER a, 
     COM.CMMN040 b
where 
 a.user_no = b.user_id
and a.user_type = 'A'
and a.user_st in ('A0001001',
'A0001002')
and substr(wkgd_cd,0,2) != '14';

