ì™„ë²½í•œ ì‹œë‚˜ë¦¬ì˜¤ë„¤ìš”! ì‹¤ì „ì²˜ëŸ¼ ì²˜ìŒë¶€í„° ëê¹Œì§€ ì•Œë ¤ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

## **í™˜ê²½ êµ¬ì„±**

```
[VM1 - ì™¸ë¶€ì„œë²„]               [VM2 - ë‚´ë¶€ì„œë²„]
CentOS 7                       CentOS 7
ì¸í„°ë„· O                       ì¸í„°ë„· X
IP: ìžë™í• ë‹¹                   IP: 192.168.56.10 (ì˜ˆì‹œ)
ì—­í• : RPM ë‹¤ìš´ë¡œë“œ             ì—­í• : ì‹¤ì œ ìš´ì˜ì„œë²„
```

---

## **Phase 1: ì™¸ë¶€ì„œë²„(VM1)ì—ì„œ íŒ¨í‚¤ì§€ ìˆ˜ì§‘**

### **1-1. í•„ìˆ˜ ë„êµ¬ ì„¤ì¹˜**

```bash
# VM1ì—ì„œ ì‹¤í–‰
sudo su -

# ë„êµ¬ ì„¤ì¹˜
yum install -y yum-utils createrepo

# ìž‘ì—… ë””ë ‰í† ë¦¬ ìƒì„±
mkdir -p /tmp/httpd-local-repo
cd /tmp/httpd-local-repo
```

### **1-2. HTTPD ë° ì˜ì¡´ì„± ë‹¤ìš´ë¡œë“œ**

```bash
# í˜„ìž¬ ë””ë ‰í† ë¦¬ì— ëª¨ë“  RPM ë‹¤ìš´ë¡œë“œ
repotrack httpd httpd-tools mod_ssl

# ë‹¤ìš´ë¡œë“œ í™•ì¸
ls -lh
```

**ì˜ˆìƒ ì¶œë ¥:**

```
apr-1.4.8-7.el7.x86_64.rpm
apr-util-1.5.2-6.el7.x86_64.rpm
httpd-2.4.6-99.el7.centos.1.x86_64.rpm
httpd-tools-2.4.6-99.el7.centos.1.x86_64.rpm
mailcap-2.1.41-2.el7.noarch.rpm
mod_ssl-2.4.6-99.el7.centos.1.x86_64.rpm
```

### **1-3. ì €ìž¥ì†Œ ë©”íƒ€ë°ì´í„° ìƒì„±**

```bash
# repodata ìƒì„± (yumì´ ì½ì„ ìˆ˜ ìžˆëŠ” í˜•ì‹)
createrepo .

# ê²°ê³¼ í™•ì¸
ls -la
```

**ì˜ˆìƒ ì¶œë ¥:**

```
drwxr-xr-x. 2 root root 4096 repodata/
-rw-r--r--. 1 root root xxxK apr-1.4.8-7.el7.x86_64.rpm
...
```

### **1-4. ì••ì¶• ë° ì²´í¬ì„¬ ìƒì„±**

```bash
# ìƒìœ„ ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd /tmp

# tar.gzë¡œ ì••ì¶•
tar czf httpd-local-repo.tar.gz httpd-local-repo/

# ì²´í¬ì„¬ ìƒì„± (ì „ì†¡ í›„ ë¬´ê²°ì„± í™•ì¸ìš©)
sha256sum httpd-local-repo.tar.gz > httpd-local-repo.tar.gz.sha256

# ìµœì¢… í™•ì¸
ls -lh httpd-local-repo.tar.gz*
```

**ì˜ˆìƒ ì¶œë ¥:**

```
-rw-r--r--. 1 root root  15M httpd-local-repo.tar.gz
-rw-r--r--. 1 root root  89  httpd-local-repo.tar.gz.sha256
```

---

## **Phase 2: íŒŒì¼ ì „ì†¡ (VM1 â†’ VM2)**

### **ë°©ë²• A: ê³µìœ  í´ë” ì‚¬ìš© (ê°€ìž¥ ì‰¬ì›€)**

```bash
# VM1ì—ì„œ
# VirtualBox ê³µìœ í´ë” ì„¤ì • í›„
mkdir -p /mnt/shared
mount -t vboxsf share /mnt/shared

# íŒŒì¼ ë³µì‚¬
cp /tmp/httpd-local-repo.tar.gz* /mnt/shared/
```

```bash
# VM2ì—ì„œ
mkdir -p /mnt/shared
mount -t vboxsf share /mnt/shared

# íŒŒì¼ ê°€ì ¸ì˜¤ê¸°
cp /mnt/shared/httpd-local-repo.tar.gz* /tmp/
```

### **ë°©ë²• B: SCP ì‚¬ìš© (ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì‹œ)**

```bash
# VM1ì—ì„œ
scp /tmp/httpd-local-repo.tar.gz* root@192.168.56.10:/tmp/
```

### **ë°©ë²• C: USB ì‹œë®¬ë ˆì´ì…˜ (ì‹¤ì „ í™˜ê²½)**

```bash
# VM1ì—ì„œ
# VirtualBox ë©”ë‰´: Devices â†’ USB â†’ USB ìž¥ì¹˜ ì„ íƒ

# USB ë§ˆìš´íŠ¸
mkdir -p /mnt/usb
mount /dev/sdb1 /mnt/usb

# íŒŒì¼ ë³µì‚¬
cp /tmp/httpd-local-repo.tar.gz* /mnt/usb/
sync  # ë²„í¼ flush
umount /mnt/usb
```

```bash
# USBë¥¼ VM2ë¡œ ì—°ê²° ë³€ê²½

# VM2ì—ì„œ
mkdir -p /mnt/usb
mount /dev/sdb1 /mnt/usb
cp /mnt/usb/httpd-local-repo.tar.gz* /tmp/
umount /mnt/usb
```

---

## **Phase 3: ë‚´ë¶€ì„œë²„(VM2)ì—ì„œ ì €ìž¥ì†Œ êµ¬ì¶•**

### **3-1. ë¬´ê²°ì„± ê²€ì¦**

```bash
# VM2ì—ì„œ ì‹¤í–‰
cd /tmp

# ì²´í¬ì„¬ í™•ì¸
sha256sum -c httpd-local-repo.tar.gz.sha256
```

**ì •ìƒ ì¶œë ¥:**

```
httpd-local-repo.tar.gz: OK
```

### **3-2. ì••ì¶• í•´ì œ ë° ë°°ì¹˜**

```bash
# ì••ì¶• í•´ì œ
tar xzf httpd-local-repo.tar.gz

# ì˜êµ¬ ì €ìž¥ ìœ„ì¹˜ë¡œ ì´ë™
mkdir -p /var/yum-repos
mv httpd-local-repo /var/yum-repos/

# ê¶Œí•œ ì„¤ì •
chmod -R 755 /var/yum-repos/httpd-local-repo

# êµ¬ì¡° í™•ì¸
tree /var/yum-repos/httpd-local-repo/ -L 1
```

**ì˜ˆìƒ ì¶œë ¥:**

```
/var/yum-repos/httpd-local-repo/
â”œâ”€â”€ apr-1.4.8-7.el7.x86_64.rpm
â”œâ”€â”€ httpd-2.4.6-99.el7.centos.1.x86_64.rpm
â”œâ”€â”€ repodata/
â””â”€â”€ ...
```

### **3-3. ê¸°ì¡´ ì €ìž¥ì†Œ ë¹„í™œì„±í™” (ì¤‘ìš”!)**

```bash
# ê¸°ì¡´ ì™¸ë¶€ ì €ìž¥ì†Œ ë¹„í™œì„±í™”
sed -i 's/enabled=1/enabled=0/g' /etc/yum.repos.d/CentOS-Base.repo

# ë˜ëŠ” ë°±ì—… í›„ ì œê±°
mkdir -p /etc/yum.repos.d/backup
mv /etc/yum.repos.d/CentOS-*.repo /etc/yum.repos.d/backup/
```

### **3-4. ë¡œì»¬ ì €ìž¥ì†Œ ë“±ë¡**

```bash
# ìƒˆ ì €ìž¥ì†Œ ì„¤ì • íŒŒì¼ ìƒì„±
cat > /etc/yum.repos.d/local-httpd.repo <<'EOF'
[local-httpd]
name=Local HTTPD Repository
baseurl=file:///var/yum-repos/httpd-local-repo
enabled=1
gpgcheck=0
priority=1
EOF

# ì„¤ì • í™•ì¸
cat /etc/yum.repos.d/local-httpd.repo
```

### **3-5. Yum ìºì‹œ ì´ˆê¸°í™”**

```bash
# ìºì‹œ ì‚­ì œ
yum clean all

# ì €ìž¥ì†Œ ëª©ë¡ í™•ì¸
yum repolist
```

**ì •ìƒ ì¶œë ¥:**

```
Loaded plugins: fastestmirror
repo id              repo name                          status
local-httpd          Local HTTPD Repository             6
repolist: 6
```

### **3-6. íŒ¨í‚¤ì§€ í™•ì¸**

```bash
# httpd íŒ¨í‚¤ì§€ ê²€ìƒ‰
yum list available httpd

# ìƒì„¸ ì •ë³´ í™•ì¸
yum info httpd
```

**ì˜ˆìƒ ì¶œë ¥:**

```
Available Packages
Name        : httpd
Arch        : x86_64
Version     : 2.4.6
Release     : 99.el7.centos.1
Size        : 2.7 M
Repo        : local-httpd
```

---

## **Phase 4: HTTPD ì„¤ì¹˜ ë° ê²€ì¦**

### **4-1. ê¸°ì¡´ HTTPD ë°±ì—… (ìžˆë‹¤ë©´)**

```bash
# ê¸°ì¡´ ì„¤ì¹˜ í™•ì¸
rpm -qa | grep httpd

# ì„¤ì¹˜ë˜ì–´ ìžˆë‹¤ë©´
systemctl stop httpd
cp -r /etc/httpd /etc/httpd.backup.$(date +%Y%m%d)
```

### **4-2. ì„¤ì¹˜ ì‹¤í–‰**

```bash
# httpd ë° mod_ssl ì„¤ì¹˜
yum install -y httpd mod_ssl httpd-tools

# ì„¤ì¹˜ í™•ì¸
rpm -qa | grep httpd
```

**ì˜ˆìƒ ì¶œë ¥:**

```
httpd-2.4.6-99.el7.centos.1.x86_64
httpd-tools-2.4.6-99.el7.centos.1.x86_64
mod_ssl-2.4.6-99.el7.centos.1.x86_64
```

### **4-3. ë²„ì „ í™•ì¸**

```bash
# HTTPD ë²„ì „ í™•ì¸
httpd -v

# ëª¨ë“ˆ í™•ì¸
httpd -M | grep ssl
```

**ì˜ˆìƒ ì¶œë ¥:**

```
Server version: Apache/2.4.6 (CentOS)
Server built:   Nov  7 2023 09:30:23

 ssl_module (shared)
```

### **4-4. SSL ì„¤ì • í™•ì¸**

```bash
# SSL ì„¤ì • íŒŒì¼ í™•ì¸
ls -l /etc/httpd/conf.d/ssl.conf

# ë¬¸ë²• ì²´í¬
httpd -t
```

**ì •ìƒ ì¶œë ¥:**

```
Syntax OK
```

### **4-5. ì„œë¹„ìŠ¤ ì‹œìž‘**

```bash
# ì„œë¹„ìŠ¤ ì‹œìž‘
systemctl start httpd

# ìƒíƒœ í™•ì¸
systemctl status httpd

# ìžë™ ì‹œìž‘ ì„¤ì •
systemctl enable httpd

# í¬íŠ¸ í™•ì¸
netstat -tlnp | grep httpd
```

**ì˜ˆìƒ ì¶œë ¥:**

```
tcp6  0  0 :::80    :::*    LISTEN  1234/httpd
tcp6  0  0 :::443   :::*    LISTEN  1234/httpd
```

---

## **Phase 5: ìµœì¢… ê²€ì¦**

### **5-1. HTTP í…ŒìŠ¤íŠ¸**

```bash
# ë¡œì»¬ í…ŒìŠ¤íŠ¸
curl -I http://localhost

# ì™¸ë¶€ ì ‘ì† í…ŒìŠ¤íŠ¸ (VM í˜¸ìŠ¤íŠ¸ì—ì„œ)
curl -I http://192.168.56.10
```

### **5-2. SSL í…ŒìŠ¤íŠ¸ (ì¸ì¦ì„œ ì„¤ì • í›„)**

```bash
# SSL ì—°ê²° í…ŒìŠ¤íŠ¸
openssl s_client -connect localhost:443 -showcerts

# ë˜ëŠ”
curl -Ik https://localhost
```

### **5-3. ë¡œê·¸ í™•ì¸**

```bash
# ì—ëŸ¬ ë¡œê·¸ í™•ì¸
tail -f /var/log/httpd/error_log

# ì•¡ì„¸ìŠ¤ ë¡œê·¸ í™•ì¸
tail -f /var/log/httpd/access_log
```

---

## **íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê°€ì´ë“œ**

### **ë¬¸ì œ 1: yum repolistì— ì €ìž¥ì†Œê°€ ì•ˆ ë³´ìž„**

```bash
# ê²½ë¡œ í™•ì¸
ls -la /var/yum-repos/httpd-local-repo/repodata/

# repodata ìž¬ìƒì„±
yum install createrepo -y  # ì™¸ë¶€ì—ì„œ ë°›ì•„ì˜¨ ê²½ìš°
createrepo --update /var/yum-repos/httpd-local-repo/

# ìºì‹œ ì‚­ì œ
rm -rf /var/cache/yum/*
yum clean all
yum repolist
```

### **ë¬¸ì œ 2: ì˜ì¡´ì„± ì˜¤ë¥˜**

```bash
# ëˆ„ë½ëœ íŒ¨í‚¤ì§€ í™•ì¸
yum deplist httpd

# VM1ì—ì„œ ì¶”ê°€ ë‹¤ìš´ë¡œë“œ
repotrack ëˆ„ë½ëœíŒ¨í‚¤ì§€ëª…

# ë‹¤ì‹œ ì „ì†¡ ë° repodata ê°±ì‹ 
```

### **ë¬¸ì œ 3: httpd ì‹œìž‘ ì‹¤íŒ¨**

```bash
# ìƒì„¸ ë¡œê·¸ í™•ì¸
journalctl -xe -u httpd

# SELinux ë¬¸ì œì¼ ê²½ìš°
setenforce 0  # ìž„ì‹œ
# ë˜ëŠ”
setsebool -P httpd_can_network_connect 1

# ë°©í™”ë²½ í™•ì¸
firewall-cmd --list-all
firewall-cmd --permanent --add-service=http
firewall-cmd --permanent --add-service=https
firewall-cmd --reload
```

---

## **ì²´í¬ë¦¬ìŠ¤íŠ¸**

### **VM1 (ì™¸ë¶€ì„œë²„) ì™„ë£Œ í•­ëª©**

- [ ] yum-utils, createrepo ì„¤ì¹˜
- [ ] repotrackìœ¼ë¡œ RPM ë‹¤ìš´ë¡œë“œ
- [ ] createrepoë¡œ ë©”íƒ€ë°ì´í„° ìƒì„±
- [ ] tar.gz ì••ì¶•
- [ ] sha256 ì²´í¬ì„¬ ìƒì„±

### **ì „ì†¡ ì™„ë£Œ í•­ëª©**

- [ ] íŒŒì¼ ë¬´ê²°ì„± ê²€ì¦ (sha256sum)

### **VM2 (ë‚´ë¶€ì„œë²„) ì™„ë£Œ í•­ëª©**

- [ ] ì••ì¶• í•´ì œ ë° /var/yum-reposë¡œ ì´ë™
- [ ] ê¸°ì¡´ ì €ìž¥ì†Œ ë¹„í™œì„±í™”
- [ ] local-httpd.repo ìƒì„±
- [ ] yum repolist í™•ì¸
- [ ] httpd ì„¤ì¹˜
- [ ] httpd -v ë²„ì „ í™•ì¸
- [ ] systemctl start httpd
- [ ] í¬íŠ¸ 80, 443 ë¦¬ìŠ¤ë‹ í™•ì¸

---

## **ì†Œìš” ì‹œê°„ ì˜ˆìƒ**

```
VM1 ìž‘ì—…: 10-15ë¶„
íŒŒì¼ ì „ì†¡: 5-10ë¶„
VM2 ìž‘ì—…: 10-15ë¶„
ê²€ì¦: 5ë¶„
ì´ ì†Œìš”: ì•½ 30-45ë¶„
```

ì´ ê³¼ì •ì„ ë”°ë¼í•˜ì‹œë©´ **ì™„ì „ížˆ ê²©ë¦¬ëœ ë‚´ë¶€ë§ì—ì„œë„ yumìœ¼ë¡œ httpdë¥¼ ì•ˆì „í•˜ê²Œ ì„¤ì¹˜**í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤! ðŸš€